!function(){"use strict";const t=()=>{let t=document.querySelector(".loader");t&&(t.style.display="block")},e=()=>{let t=document.querySelector(".loader");t&&(t.style.display="none")},n=t=>{let e=new URLSearchParams(window.location.search),n=e.get("sid")?e.get("sid"):"",a=-1==t.indexOf("?")?"?sid="+n:"&sid="+n;return t+a},a=()=>{let t=new URLSearchParams(window.location.search);return t.get("sid")?t.get("sid"):""},o=t=>{let e=t+"=",n=decodeURIComponent(document.cookie).split(";");for(let t=0;t<n.length;t++){let a=n[t];for(;" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(e))return a.substring(e.length,a.length)}return""},i={Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o("kenzap_api_key"),"Kenzap-Locale":o("locale")?o("locale"):"en","Kenzap-Header":localStorage.hasOwnProperty("header")&&localStorage.hasOwnProperty("header-version")?localStorage.getItem("header-version"):0,"Kenzap-Token":o("kenzap_token"),"Kenzap-Sid":a()},s=t=>{if(console.log(t),isNaN(t.code)){let e=t;try{e=JSON.stringify(e)}catch(t){}let n=new URLSearchParams;return n.append("cmd","report"),n.append("sid",a()),n.append("token",o("kenzap_token")),n.append("data",e),fetch("https://api-v1.kenzap.cloud/error/",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded"},body:n}),void alert("Can not connect to Kenzap Cloud")}if(401===t.code){if(-1!=window.location.href.indexOf("localhost"))return void alert(t.reason);location.href="https://auth.kenzap.com/?app=65432108792785&redirect="+window.location.href}else alert(t.reason)},r=(t,e)=>{if(document.querySelector(t))for(let n of document.querySelectorAll(t))n.removeEventListener("click",e,!0),n.addEventListener("click",e,!0)};var d={state:{firstLoad:!0,ajaxQueue:0,tld:[".kenzap.site",".kenzap.tech",".warung.menu"],tldType:"custom",dataAPI:null,data:null},init:function(){d.getData(),d.getAPIData()},getAPIData:function(){var t=new URLSearchParams;t.append("cmd","get_site_domain"),t.append("id",a()),t.append("token",o("kenzap_token")),fetch("https://siteapi.kenzap.cloud/v1/",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded"},body:t}).then((function(t){return t.json()})).then((function(t){e(),t.success?(d.state.dataAPI=t,d.startRender()):s(t)})).catch((function(t){console.error("Error:",t)}))},getData:function(){d.state.firstLoad&&t(),fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:i,body:JSON.stringify({query:{user:{type:"authenticate",fields:["avatar"],token:o("kenzap_token")},locale:{type:"locale",id:o("lang")}}})}).then((function(t){return t.json()})).then((function(t){d.state.data=t,e(),t.success?((t=>{if(t.header&&localStorage.setItem("header",t.header),!document.querySelector("#k-script")){let t=document.createElement("div");t.innerHTML=localStorage.getItem("header"),t=t.firstChild,document.body.prepend(t),Function(document.querySelector("#k-script").innerHTML).call("test")}t.locale&&window.i18n.init(t.locale)})(t),d.startRender()):s(t)})).catch((function(t){console.error("Error:",t)}))},startRender:function(){null!=d.state.data&&null!=d.state.dataAPI&&(d.loadPageStructure(),d.renderPage(d.state.data),d.initListeners(),d.initFooter(),d.state.firstLoad=!1)},renderPage:function(t){var e=document;if((t=>{let e='<ol class="breadcrumb mt-2 mb-0">';for(let n of t)void 0===n.link?e+=`<li class="breadcrumb-item">${n.text}</li>`:e+=`<li class="breadcrumb-item"><a href="${n.link}">${n.text}</a></li>`;e+="</ol>",document.querySelector(".bc").innerHTML=e})([{link:n("/"),text:__("Dashboard")},{text:__("Domain settings")}]),d.state.dataAPI.domain){for(var a in d.state.tld)d.state.dataAPI.domain.indexOf(d.state.tld[a])>0&&(d.state.tldType=d.state.tld[a]);if("custom"==d.state.tldType)e.querySelector(".val-tld").value=d.state.dataAPI.domain;else{var o=d.state.dataAPI.domain.replace(d.state.tldType,"");e.querySelector(".val-tld").value=o,e.querySelector(".val-tld").innerHTML=d.state.tldType}}},rowStruct:function(t,e){var n=new Image;return n.onload=function(){document.querySelector("#img"+this.kid).setAttribute("src",this.src)},n.kid=e.kid,n.src="https://kenzap.b-cdn.net/150/a"+e.kid+"_1.jpeg",'\n        <tr data-sec="0" >\n            <td>\n                <b>'.concat(e.kid,'</b>\n            </td>\n            <td class="name">\n                <div class="object-img">\n                    <img id=\'img').concat(e.kid,'\' src="https://account.kenzap.com/images/default_avatar.jpg" alt="user avatar">\n                </div>\n                <b>').concat(e.name,"</b>\n            </td>\n            <td>\n                <b>").concat(d.getType(e.role),'</b>\n            </td>\n            <td>\n                <div class="d2 d-flex justify-content-end">\n                    <a href="javascript:void(0);" onclick="javascript:;" >\n                        <svg xmlns="http://www.w3.org/2000/svg" data-kid=\'').concat(e.kid,'\' width="16" height="16" fill="currentColor" class="bi bi-trash text-danger edit-user d-none" viewBox="0 0 16 16">\n                            <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>\n                            <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>\n                        </svg>\n                    </a>\n                    <a href="javascript:void(0);" onclick="javascript:;" >\n                        <svg xmlns="http://www.w3.org/2000/svg" style="').concat(parseInt(e.kid)==parseInt(t)?"display:none;":"","\"  data-kid='").concat(e.kid,'\' width="16" height="16" fill="currentColor" class="bi bi-trash text-danger remove-user" viewBox="0 0 16 16">\n                            <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>\n                            <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>\n                        </svg>\n                    </a>\n                </div>\n            </td>\n        </tr>')},getType:function(t){var e="";switch(t){case"admin":e='<div title="Administrator" class="badge bg-danger fw-light">Administrator</div>';break;case"editor":e='<div title="Editor" class="badge bg-primary fw-light">Editor</div>';break;case"viewer":e='<div title="Viewer" class="badge bg-success fw-light">Viewer</div>'}return e},initHeader:function(t){r(".nav-back",(function(t){t.preventDefault(),console.log(".nav-back"),(t=>{let e=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});t.dispatchEvent(e)})(document.querySelector(".bc ol li:nth-last-child(2)").querySelector("a"))}))},initListeners:function(){console.log("initListeners "),d.state.firstLoad&&(r(".domain-list li a",d.listeners.domainChange),r(".btn-apply",d.listeners.applyChanges))},listeners:{applyChanges:function(e){if(e.preventDefault(),t(),"true"!==modal.querySelector(".btn-primary").dataset.loading){document.querySelector(".btn-apply").dataset.loading=!0;var n=document.querySelector(".val-tld").value;if(confirm(__("This will change your website URL permanently."))){var i=new bootstrap.Toast(document.querySelector(".toast"));"custom"!=d.state.tldType&&(n+=d.state.tldType);var r=new URLSearchParams;r.append("cmd","set_site_domain"),r.append("id",a()),r.append("domain",n),r.append("token",o("kenzap_token")),fetch("https://siteapi.kenzap.cloud/v1/",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded"},body:r}).then((function(t){return t.json()})).then((function(t){document.querySelector(".btn-apply").dataset.loading=!1,t.success?(document.querySelector(".toast .toast-body").innerHTML=__("Changes applied"),i.show()):s(t),console.log("Success:",t)})).catch((function(t){console.error("Error:",t)}))}}},domainChange:function(t){t.preventDefault(),document.querySelector(".btn-tld").innerHTML=t.currentTarget.innerHTML,d.state.tldType=t.currentTarget.dataset.key},modalSuccessBtn:function(t){d.listeners.modalSuccessBtnFunc(t)},modalSuccessBtnFunc:null},loadPageStructure:function(){d.state.firstLoad&&(document.querySelector("#contents").innerHTML=function(t){return'\n    <div class="container">\n      <div class="d-flex justify-content-between bd-highlight mb-3">\n          <nav class="bc" aria-label="breadcrumb"></nav>\n          <button class="btn btn-primary btn-add d-none" type="button">'.concat(t("Add user"),'</button>\n      </div> \n      \n      <div class="row">\n        <div class="col-md-12 grid-margin grid-margin-lg-0 grid-margin-md-0 stretch-card">\n          <div class="card border-white shadow-sm br">\n            <div class="card-body">\n              <h4 class="mb-4">').concat(t("Domain Settings"),'</h4>\n              <p class="card-description">').concat(t("Connect your cloud space with a range of free premium domains."),'</p>\n              <div class="domain" style="max-width: 500px;"> \n\n                <div class="form-group">\n                  <div class="input-group">\n\n                    <div class="input-group">\n                      <input type="text" style="text-align:right;" class="form-control val-tld" aria-label="">\n                      <button class="btn btn-sm btn-outline-primary dropdown-toggle btn-tld" data-bs-toggle="dropdown" aria-expanded="false">.kenzap.site</button>\n                      <ul class="dropdown-menu dropdown-menu-end domain-list">\n                        <li><a class="dropdown-item" href="#" data-key=\'.kenzap.site\'>.kenzap.site</a></li>\n                        <li><a class="dropdown-item d-none" href="#" data-key=\'.warung.menu\'>.warung.menu</a></li>\n                        <li><a class="dropdown-item d-none" href="#" data-key=\'.kenzap.tech\'>.kenzap.tech</a></li>\n                        <li><hr class="dropdown-divider"></li>\n                        <li><a class="dropdown-item" href="#" data-key=\'custom\'>My domain</a></li>\n                      </ul>\n                    </div>\n                  </div>\n                </div>\n\n                <h5 class="card-title mt-4">').concat(t("* kenzap.site domain"),'</h5>\n                <p class="form-text" >').concat(t("1. Choose free premium domain from the list above"),'</p>\n                <p class="form-text" >').concat(t("2. Hit publish button below"),'</p>\n                <hr> \n                <h5 class="card-title mt-4">').concat(t("* my domain"),'</h5>\n                <p class="form-text" >').concat(t("1. Purchase domain with your registrar"),'</p>\n                <p class="form-text" >').concat(t("2. Point this domain to Kenzap Cloud"),'</p>\n                <p class="form-text" >').concat(t("3. Type your domain in the field above"),'</p>\n                <p class="form-text" >').concat(t("4. Hit publish button below"),'</p>\n      \n              </div>\n              <div class="d-flex justify-content-between bd-highlight mb-1 mt-4 align-items-center">\n                <button type="button" class="btn btn-outline-primary btn-fw btn-icon-text nav-deactivate btn-apply" id="publish">').concat(t("Apply changes"),'</button>\n                <p class="float-right form-text ms-3 mt-3">Contact support <a href="mailto:support@kenzap.com">support@kenzap.com</a></p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>    \n    </div>\n\n    <div class="modal" tabindex="-1">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h5 class="modal-title"></h5>\n                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body">\n\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary btn-modal"></button>\n                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"></button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class="position-fixed bottom-0 p-2 m-4 end-0 align-items-center">\n        <div class="toast hide align-items-center text-white bg-dark border-0" role="alert" aria-live="assertive"\n            aria-atomic="true" data-bs-delay="3000">\n            <div class="d-flex">\n                <div class="toast-body"></div>\n                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"\n                    aria-label="Close"></button>\n            </div>\n        </div>\n    </div>\n    ')}(__))},initFooter:function(){var t,e;t=__("Created by %1$Kenzap%2$. ❤️ Licensed %3$GPL3%4$.",'<a class="text-muted" href="https://kenzap.com/" target="_blank">',"</a>",'<a class="text-muted" href="https://github.com/kenzap/dashboard" target="_blank">',"</a>"),e=__("Copyright © %1$ %2$Dashboard%3$ Extension",(new Date).getFullYear(),'<a class="text-muted" href="https://github.com/kenzap/dashboard" target="_blank">',"</a>"),document.querySelector("footer .row").innerHTML=`\n    <div class="d-sm-flex justify-content-center justify-content-sm-between">\n        <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">${t}</span>\n        <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center text-muted">${e}</span>\n    </div>`}};d.init()}();
